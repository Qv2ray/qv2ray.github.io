(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{405:function(_,v,e){"use strict";e.r(v);var t=e(16),a=Object(t.a)({},(function(){var _=this,v=_.$createElement,e=_._self._c||v;return e("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[e("h1",{attrs:{id:"qv2ray-を手動でビルド"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#qv2ray-を手動でビルド"}},[_._v("#")]),_._v(" Qv2ray を手動でビルド")]),_._v(" "),e("p",[_._v("ハッカーがQv2rayを手動でコンパイルしたい場合。")]),_._v(" "),e("h2",{attrs:{id:"_0-要件と依存関係"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_0-要件と依存関係"}},[_._v("#")]),_._v(" 0. 要件と依存関係")]),_._v(" "),e("p",[_._v("すべての要件を満たしていることを確認してください。")]),_._v(" "),e("ul",[e("li",[e("p",[e("code",[_._v("x64")]),_._v("デスクトッププラットフォームのみ。")])]),_._v(" "),e("li",[e("p",[e("code",[_._v("arm")]),_._v(", "),e("code",[_._v("arm64")]),_._v(", "),e("code",[_._v("x86")]),_._v(", "),e("code",[_._v("x86_64")]),_._v(" Androidプラットフォーム用.")])]),_._v(" "),e("li",[e("p",[_._v("Qt version"),e("code",[_._v(">= 5.11")]),_._v(" is required for desktop platforms, "),e("code",[_._v(">= 6.0")]),_._v(" required for Android")]),_._v(" "),e("ul",[e("li",[_._v("~~Qv2rayを以前またはそれ以降のQt.~に移植する場合は気にしないでください。")]),_._v(" "),e("li",[_._v("その場合は、 "),e("code",[_._v("CMakeLists.txt")]),_._v(" で "),e("code",[_._v("QV_QT_MAJOR_VERSION")]),_._v(" と "),e("code",[_._v("QV_QT_MINOR_VERSION")]),_._v(" を変更することができます。")])])]),_._v(" "),e("li",[e("p",[_._v("最新バージョンのQtは常にサポートされ、推奨されています")])]),_._v(" "),e("li",[e("p",[e("code",[_._v("std=c++17")]),_._v(" をサポートするコンパイラ:")]),_._v(" "),e("ul",[e("li",[e("code",[_._v("gcc7")]),_._v("はうまくいくことが知られている。")]),_._v(" "),e("li",[_._v("少なくともMSVCのバージョン14.2が必要です。")])])]),_._v(" "),e("li",[e("p",[_._v("サードパーティ製ライブラリ: (gRPC, protobuf, curl, openssl)")]),_._v(" "),e("table",[e("thead",[e("tr",[e("th",[_._v("ターゲットプラットフォーム")]),_._v(" "),e("th",[_._v("インストール方法")])])]),_._v(" "),e("tbody",[e("tr",[e("td",[_._v("Linux")]),_._v(" "),e("td",[_._v("対応するパッケージをインストール")])]),_._v(" "),e("tr",[e("td",[_._v("Windows (MSVC)")]),_._v(" "),e("td",[e("code",[_._v("vcpkg")]),_._v(" を使用するか、 "),e("a",{attrs:{href:"#a-prebuilt-binaries"}},[e("strong",[_._v("のビルド済みバイナリ")]),_._v("を使用してください")])])]),_._v(" "),e("tr",[e("td",[_._v("Windows (MinGW)")]),_._v(" "),e("td",[e("a",{attrs:{href:"#mingw-packages"}},[_._v("の下を見る")])])]),_._v(" "),e("tr",[e("td",[_._v("macOS")]),_._v(" "),e("td",[e("code",[_._v("homebrew")]),_._v("を使ってパッケージをインストールします（注意: curl がプリインストールされています）")])]),_._v(" "),e("tr",[e("td",[_._v("Android")]),_._v(" "),e("td",[_._v("Linux ホストがサポートされています。 "),e("a",{attrs:{href:"#a-prebuilt-binaries"}},[e("strong",[_._v("事前ビルドバイナリ")])]),_._v(" を使用してください")])])])]),_._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[_._v("Extra Git Submoule for Android [android-openssl](https://github.com/KDAB/android_openssl) は OpenSSL バイナリを提供します: use `git clone https://github.com/KDAB/android_openssl 3rdparty/android-openssl` :::")])])])]),_._v(" "),e("h3",{attrs:{id:"a-構築済みのバイナリ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#a-構築済みのバイナリ"}},[_._v("#")]),_._v(" a 構築済みのバイナリ")]),_._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/Qv2ray/Qv2ray-deps/",target:"_blank",rel:"noopener noreferrer"}},[_._v("Qv2ray-deps"),e("OutboundLink")],1),_._v(" リポジトリは、WindowsとAndroidをターゲットとするライブラリの依存関係を構築し提供する場所です。")]),_._v(" "),e("li",[_._v("Android版では、 "),e("a",{attrs:{href:"https://github.com/Qv2ray/Qv2ray-deps/blob/master/0001_vcpkg_fix_curl_android_build.patch",target:"_blank",rel:"noopener noreferrer"}},[_._v("パッチを当てた"),e("OutboundLink")],1),_._v(" vcpkgを使用しています。")])]),_._v(" "),e("h4",{attrs:{id:"a-1-ダウンロード-抽出スクリプト"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#a-1-ダウンロード-抽出スクリプト"}},[_._v("#")]),_._v(" a.1 ダウンロード / 抽出スクリプト")]),_._v(" "),e("p",[e("strong",[_._v("余分な依存関係: bash, jq, curl, 7zip")]),_._v(" (特に Windows ユーザ向け)")]),_._v(" "),e("p",[e("code",[_._v("./libs/setup-lib.sh")]),_._v(" を用意し、ビルド済みのバイナリを簡単にインストールできるようにしました。")]),_._v(" "),e("ul",[e("li",[e("code",[_._v("cd")]),_._v(" to "),e("code",[_._v("libs")]),_._v(" ディレクトリ")]),_._v(" "),e("li",[e("code",[_._v("./setup-libs <PLATFORM> <ARCH>")]),_._v(" "),e("ul",[e("li",[_._v("例: "),e("code",[_._v("./setup-libs.sh windows x64")]),_._v(" または "),e("code",[_._v("./setup-libs.sh android arm")])]),_._v(" "),e("li",[_._v("可能な "),e("code",[_._v("<PLATFORM>")]),_._v(" 値: "),e("code",[_._v("windows")]),_._v(", "),e("code",[_._v("linux")]),_._v(", "),e("code",[_._v("android")])]),_._v(" "),e("li",[_._v("possible "),e("code",[_._v("<ARCH>")]),_._v(" values: "),e("code",[_._v("x86")]),_._v(", "),e("code",[_._v("x64")]),_._v(", "),e("code",[_._v("arm")]),_._v(", "),e("code",[_._v("arm64")])]),_._v(" "),e("li",[_._v("LinuxでAndroidにクロスコンパイルするときにProtobufジェネレータバイナリをインストールするには、 "),e("code",[_._v("<ARCH>")]),_._v(" を "),e("code",[_._v("tools")]),_._v(" に設定してください。")])])])]),_._v(" "),e("p",[_._v("スクリプトは "),e("a",{attrs:{href:"https://github.com/Qv2ray/Qv2ray-deps/releases/tag/release",target:"_blank",rel:"noopener noreferrer"}},[_._v("このリリース"),e("OutboundLink")],1),_._v(" からパッケージをダウンロードし、内容をcorrensponding "),e("code",[_._v("./libs/ARCH-PLATFORM/")]),_._v(" ディレクトリに移動します。")]),_._v(" "),e("h4",{attrs:{id:"a-2-手動でビルド済みのバイナリを取得"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#a-2-手動でビルド済みのバイナリを取得"}},[_._v("#")]),_._v(" a.2 手動でビルド済みのバイナリを取得")]),_._v(" "),e("ul",[e("li",[_._v("7zファイルをダウンロード")]),_._v(" "),e("li",[e("code",[_._v("{7Z_ROOT}/PLATFORM-ARCH/installed/ARCH-PLATFORM")]),_._v(" を "),e("code",[_._v("./libs/")]),_._v(" ディレクトリに展開して移動します。")]),_._v(" "),e("li",[e("code",[_._v("include")]),_._v(", "),e("code",[_._v("lib")]),_._v(" または `` サブディレクトリを "),e("code",[_._v("./libs/ARCH-PLATFORM")]),_._v(" で共有する必要があります。\n"),e("ul",[e("li",[_._v("例: "),e("code",[_._v("./libs/x86-android/include")]),_._v(" または "),e("code",[_._v("./libs/x64-windows/include/")]),_._v(" が存在します")])])])]),_._v(" "),e("h3",{attrs:{id:"mingwパッケージ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mingwパッケージ"}},[_._v("#")]),_._v(" MinGWパッケージ:")]),_._v(" "),e("p",[_._v("MSYS2が提案されているパッケージ:")]),_._v(" "),e("ul",[e("li",[e("code",[_._v("mingw-w64-x86_64-grpc")])]),_._v(" "),e("li",[e("code",[_._v("mingw-w64-x86_64-curl")])]),_._v(" "),e("li",[e("code",[_._v("mingw-w64-x86_64-protobuf")])]),_._v(" "),e("li",[e("code",[_._v("mingw-w64-x86_64-protobuf-c")])]),_._v(" "),e("li",[e("code",[_._v("mingw-w64-x86_64-pkg-config")])]),_._v(" "),e("li",[e("code",[_._v("mingw-w64-x86_64-re2")])])]),_._v(" "),e("h2",{attrs:{id:"_1-ソースツリーの取得"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-ソースツリーの取得"}},[_._v("#")]),_._v(" 1. ソースツリーの取得")]),_._v(" "),e("p",[_._v("Qv2rayのソースコードを取得するには様々なアプローチがあります。 以下から入手できます:")]),_._v(" "),e("ul",[e("li",[_._v("Git:"),e("code",[_._v("https://github.com/Qv2ray/Qv2ray.git")])]),_._v(" "),e("li",[_._v("ブランチのソースコードを直接ダウンロードする ("),e("strong",[_._v("git submodule metadata がないため、これを行うことはありません。 ** )")]),_._v(") :::tip "),e("code",[_._v("git clone")]),_._v(" "),e("code",[_._v("--branch <branch/tag>")]),_._v(" クローン作成後に特定のブランチ/タグをチェックアウトすることができます。 :::")])]),_._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[_._v("Qv2ray にはネストされたサブモジュールが含まれており、クローンするときは常に `--recursive` を使用します。 :::")]),_._v(" "),e("h2",{attrs:{id:"_2-コンパイルディレクトリに入る"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-コンパイルディレクトリに入る"}},[_._v("#")]),_._v(" 2. コンパイルディレクトリに入る")]),_._v(" "),e("p",[_._v("次のステップでは、適切な "),e("code",[_._v("PATH")]),_._v("を必要とします。つまり、 "),e("code",[_._v("qmake")]),_._v(" は "),e("code",[_._v("PATH")]),_._v(" にあります。")]),_._v(" "),e("p",[_._v("実行: "),e("code",[_._v("mkdir build; cd build;")])]),_._v(" "),e("ul",[e("li",[_._v("単にソースツリーの汚染を防ぐために。")])]),_._v(" "),e("h2",{attrs:{id:"_3-コンパイルスクリプトの生成"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-コンパイルスクリプトの生成"}},[_._v("#")]),_._v(" 3. コンパイルスクリプトの生成")]),_._v(" "),e("p",[e("strong",[_._v("は")]),_._v(" "),e("a",{attrs:{href:"cmake-argument"}},[_._v("CMake Argument References")]),_._v(" をチェックし、独自のものを追加する必要があります。")]),_._v(" "),e("p",[_._v("実行: "),e("code",[_._v("cmake ..")])]),_._v(" "),e("p",[e("em",[e("strong",[_._v("Androidでは、 "),e("code",[_._v("qt-cmake ..")]),_._v(" を使用することをお勧めします。 "),e("code",[_._v("cmake ..")]),_._v(" の代わりに。")])])]),_._v(" "),e("ul",[e("li",[e("code",[_._v("CMAKE_INSTALL_PREFIX")]),_._v(" は、必要なすべてのファイルを一度にパッケージ化して収集するために常に提案されています。")]),_._v(" "),e("li",[e("code",[_._v("CMAKE_BUILD_TYPE")]),_._v(" は常に提案されています。 "),e("a",{attrs:{href:"https://cmake.org/cmake/help/latest/variable/CMAKE_BUILD_TYPE.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("CMake Documentation"),e("OutboundLink")],1),_._v(" を参照してください。\n"),e("ul",[e("li",[e("code",[_._v("Debug")]),_._v(" と "),e("code",[_._v("Release")]),_._v(" ビルドは、Qv2ray 設定ディレクトリの名前が異なります。 開発ビルドが構成のコピーを損なうのを防ぐために")])])]),_._v(" "),e("li",[e("code",[_._v("-GNinja")]),_._v(" が提案されている, iff you have "),e("code",[_._v("Ninja")]),_._v(" or "),e("code",[_._v("ninja-build")]),_._v(" がインストールされている.")]),_._v(" "),e("li",[e("code",[_._v("ANDROID_SDK_ROOT")]),_._v(" または "),e("code",[_._v("ANDROID_NDK_ROOT")]),_._v(" は、Android では必須である。")])]),_._v(" "),e("h2",{attrs:{id:"_4-コンパイルを開始"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-コンパイルを開始"}},[_._v("#")]),_._v(" 4. コンパイルを開始")]),_._v(" "),e("p",[_._v("コンパイルを開始します！")]),_._v(" "),e("p",[_._v("実行: "),e("code",[_._v("cmake --build .")])]),_._v(" "),e("ul",[e("li",[e("code",[_._v("--parallel <NUMBER>")]),_._v(" は十分な計算能力があり、並列コンパイルを実行したい場合は sugguest です。")])]),_._v(" "),e("h2",{attrs:{id:"_5-コンパイルを完了"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-コンパイルを完了"}},[_._v("#")]),_._v(" 5. コンパイルを完了")]),_._v(" "),e("p",[_._v("コンパイルされたアーティファクトとリソースを宛先ディレクトリにコピーします。")]),_._v(" "),e("p",[_._v("実行: "),e("code",[_._v("cmake --install .")]),_._v(" または "),e("code",[_._v("sudo")])]),_._v(" "),e("ul",[e("li",[_._v("全ての依存関係を "),e("code",[_._v("CMAKE_INSTALL_PREFIX")]),_._v(" に自動的にコピーします。")])]),_._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[_._v("`macdeployqt` に `libabsl_debugging_internal` がデバッグライブラリとして認識されるバグがあります。 QPlatformPlugin を防ぎます (例: QCocoaPlugin)がデプロイされていません。 これにより、「プラットフォームプラグインが見つかりません」という実行時例外が発生します。")]),_._v(" "),e("p",[_._v("代わりに "),e("a",{attrs:{href:"https://github.com/Qv2ray/macdeployqt-patched",target:"_blank",rel:"noopener noreferrer"}},[_._v("Qv2ray-patched "),e("code",[_._v("macdeployqt")]),e("OutboundLink")],1),_._v(" を使用してください。 Qt5とQt6の両方をサポートする :::")]),_._v(" "),e("h2",{attrs:{id:"_6-完了"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-完了"}},[_._v("#")]),_._v(" 6. 完了")]),_._v(" "),e("p",[_._v("Qv2rayをコンパイルして配備しました！")]),_._v(" "),e("p",[_._v("ハッキングを開始し、Qv2rayに貢献することを歓迎!")])])])])}),[],!1,null,null,null);v.default=a.exports}}]);