(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{404:function(v,_,o){"use strict";o.r(_);var t=o(16),e=Object(t.a)({},(function(){var v=this,_=v.$createElement,o=v._self._c||_;return o("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[o("h1",{attrs:{id:"高级路由设置"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#高级路由设置"}},[v._v("#")]),v._v(" 高级路由设置")]),v._v(" "),o("p",[o("strong",[v._v("高级路由设置")]),v._v(" 和 "),o("strong",[v._v("路由编辑器")]),v._v(" 是Qv2ray的特有功能。这两项功能可以帮助您精确地控制流量，如 "),o("strong",[v._v("按需代理")]),v._v("，"),o("strong",[v._v("分流国内/国外网站")]),v._v("等。你甚至可以 **设置代理链(多层套娃)**🤣~")]),v._v(" "),o("p",[v._v(":::  路由功能是什么？为什么不用 PAC 和 GFW List？")]),v._v(" "),o("p",[v._v("如果你不了解 V2ray 的路由功能具体是什么，那么你可以把它理解为一个更加简便，高效且精准的新一代 PAC 实现。")]),v._v(" "),o("p",[v._v("路由功能 比 PAC 强大太多，以后请别再问为什么 Qv2ray 不支持 PAC 了。路由功能所采用的分流表也比 GFW List 更加完善，完全没有必要再使用GFW List。")]),v._v(" "),o("p",[v._v(":::")]),v._v(" "),o("h2",{attrs:{id:"全局路由规则"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#全局路由规则"}},[v._v("#")]),v._v(" 全局路由规则")]),v._v(" "),o("p",[v._v("配置全局路由规则 请打开"),o("strong",[v._v("首选项")]),v._v(" ---\x3e "),o("strong",[v._v("高级路由设置")]),v._v(" 。")]),v._v(" "),o("h3",{attrs:{id:"域名策略"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#域名策略"}},[v._v("#")]),v._v(" 域名策略")]),v._v(" "),o("p",[v._v("Qv2ray 有三种域名匹配策略可选： "),o("code",[v._v("AsIs")]),v._v("、"),o("code",[v._v("IPIfNonMatch")]),v._v(" 和 "),o("code",[v._v("IPOnDemand")]),v._v("。")]),v._v(" "),o("p",[v._v("根据V2Ray的官方文档，这三种域名策略的定义如下：")]),v._v(" "),o("ul",[o("li",[o("strong",[o("code",[v._v("AsIs")])]),v._v("：只使用域名进行路由选择，默认值;")]),v._v(" "),o("li",[o("strong",[o("code",[v._v("IPIfNonMatch")])]),v._v("：当域名没有匹配任何规则时，将域名解析成 IP（A 记录或 AAAA 记录）后再次进行匹配；\n"),o("ul",[o("li",[v._v("当一个域名有多个 A 记录时，会尝试匹配所有的 A 记录，直到其中一个与某个规则匹配为止；")]),v._v(" "),o("li",[v._v("解析后的 IP 仅在路由选择时起作用，转发的数据包中依然使用原始域名;")])])]),v._v(" "),o("li",[o("strong",[o("code",[v._v("IPOnDemand")])]),v._v("：匹配时碰到任何基于 IP 的规则，立即将域名解析为 IP 后进行匹配;")])]),v._v(" "),o("p",[v._v("用某位开发者的话说，就是：")]),v._v(" "),o("ul",[o("li",[o("strong",[o("code",[v._v("AsIs")])]),v._v("：分流速度快，但分流不够精确;")]),v._v(" "),o("li",[o("strong",[o("code",[v._v("IPIfNonMatch")])]),v._v("：在牺牲部分速度的同时能带来足够精确的分流;")]),v._v(" "),o("li",[o("strong",[o("code",[v._v("IPOndemand")])]),v._v("：别用;")])]),v._v(" "),o("blockquote",[o("p",[v._v("请注意: "),o("code",[v._v("IPOnDemand")]),v._v(" 理论上是最慢而结果最准确的，然而在大多数情况下 "),o("code",[v._v("IPIfNonMatch")]),v._v(" 已经足够准确了，所以 "),o("code",[v._v("IPOndemand")]),v._v(" 的实际应用效果并不明显。")])]),v._v(" "),o("p",[v._v("您可以根据您的实际需求选择最适合你的域名匹配策略。但就结果来说，一般情况下，"),o("code",[v._v("IPIfNonMatch")]),v._v(" 是最佳选择。")]),v._v(" "),o("h3",{attrs:{id:"路由策略"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#路由策略"}},[v._v("#")]),v._v(" 路由策略")]),v._v(" "),o("p",[v._v("路由策略由 "),o("code",[v._v("3x2")]),v._v("  个区块组成，他们分别是（左上到右下）："),o("code",[v._v("IP 直连")]),v._v("、"),o("code",[v._v("IP 代理")]),v._v("、"),o("code",[v._v("IP 阻断")]),v._v("、"),o("code",[v._v("域名直连")]),v._v("、"),o("code",[v._v("域名代理")]),v._v("、"),o("code",[v._v("域名阻断")]),v._v("，填入规则时请保持 "),o("strong",[v._v("每行一个，中间没有逗号分隔")]),v._v("。")]),v._v(" "),o("p",[v._v("Qv2ray 对于这些策略组的优先级排序是："),o("code",[v._v("域名阻断")]),v._v(" -> "),o("code",[v._v("域名代理")]),v._v(" -> "),o("code",[v._v("域名直连")]),v._v(" -> "),o("code",[v._v("IP 阻断")]),v._v(" -> "),o("code",[v._v("IP 代理")]),v._v(" -> "),o("code",[v._v("IP 直连")]),v._v("。如果最后没有成功匹配，私有地址 和 中国大陆地址 会默认直连，其他地址则会使用代理。")]),v._v(" "),o("div",{staticClass:"custom-block tip"},[o("p",{staticClass:"custom-block-title"},[v._v("我就想要全局代理~~~ 🤗")]),v._v(" "),o("p",[v._v("很简单，清空所有的路由规则 然后打开 "),o("strong",[v._v("首选项")]),v._v(" ---\x3e "),o("strong",[v._v("链接设置")]),v._v(" 取消勾选 "),o("strong",[v._v("绕过私有地址")]),v._v(" 和 "),o("strong",[v._v("绕过中国大陆")]),v._v(" 即可 🙄")])]),v._v(" "),o("p",[v._v("根据 V2Ray 官方文档：")]),v._v(" "),o("p",[v._v("IP规则有以下几种写法(按照是否常用排序):")]),v._v(" "),o("ul",[o("li",[o("strong",[v._v("GeoIP")]),v._v('：形如 "geoip:cn"，必须以 geoip:（小写）开头，后面跟双字符国家代码。例如 '),o("code",[v._v("geoip:cn")]),v._v(" 包含了常见的中国IP地址，"),o("code",[v._v("geoip:us")]),v._v(" 包含了常见的美国IP地址；")]),v._v(" "),o("li",[v._v('特殊值："geoip:private"（仅支持V2Ray 3.5+），包含所有私有地址，如 127.0.0.1。')]),v._v(" "),o("li",[v._v('IP：直接填写，形如 "127.0.0.1"。')]),v._v(" "),o("li",[o("strong",[v._v("CIDR")]),v._v('：形如 "10.0.0.0/8"。')]),v._v(" "),o("li",[o("strong",[v._v("从文件中加载 IP")]),v._v("：形如 "),o("code",[v._v('"ext:file:tag"')]),v._v("，必须以 "),o("code",[v._v("ext:")]),v._v("（小写）开头，后面跟文件名（不带扩展名）和 标签，文件存放在 和 v2ray 核心文件相同的路径中。文件格式与 "),o("code",[v._v("geoip.dat")]),v._v(" 相同，标签 必须在文件中声明。")])]),v._v(" "),o("p",[v._v("域名规则有以下几种写法(按照是否常用排序):")]),v._v(" "),o("ul",[o("li",[o("strong",[v._v("预定义域名列表")]),v._v("：以 "),o("code",[v._v("geosite:")]),v._v(" 开头，后面跟一个名称，例如 "),o("code",[v._v("geosite:google")]),v._v(" 或 "),o("code",[v._v("geosite:cn")]),v._v(" 名称 及 域名列表 请参考 "),o("em",[v._v("预定义域名列表")])]),v._v(" "),o("li",[o("strong",[v._v("子域名")]),v._v("：由 "),o("code",[v._v('"domain:"')]),v._v(" 开始，后面跟一个域名。当此域名是目标域名或其子域名时，该规则生效。例如 "),o("code",[v._v('"domain:v2ray.com"')]),v._v(" 匹配 "),o("code",[v._v('"www.v2ray.com"')]),v._v("、"),o("code",[v._v('"v2ray.com"')]),v._v("，但不匹配 "),o("code",[v._v('"xv2ray.com"')]),v._v("。")]),v._v(" "),o("li",[o("strong",[v._v("完全匹配")]),v._v("： 由 "),o("code",[v._v('"full:"')]),v._v(" 开始，后面跟一个域名。当此域名完整匹配目标域名时，该规则生效。例如 "),o("code",[v._v('"full:v2ray.com"')]),v._v(" 匹配 "),o("code",[v._v('"v2ray.com"')]),v._v(" 但不匹配 "),o("code",[v._v('"www.v2ray.com"')]),v._v("。")]),v._v(" "),o("li",[o("strong",[v._v("纯字符串")]),v._v("：当此字符串匹配目标域名中任意部分，该规则生效。比如 "),o("code",[v._v('"sina.com"')]),v._v(" 可以匹配 "),o("code",[v._v('"sina.com"')]),v._v("、"),o("code",[v._v('"sina.com.cn"')]),v._v(" 和 "),o("code",[v._v('"www.sina.com"')]),v._v("，但不匹配 "),o("code",[v._v('"sina.cn"')]),v._v("。")]),v._v(" "),o("li",[o("strong",[v._v("正则表达式")]),v._v("：由 "),o("code",[v._v('"regexp:"')]),v._v(" 开始，余下部分是一个正则表达式。当此正则表达式匹配目标域名时，该规则生效。例如 "),o("code",[v._v('"regexp:\\\\.goo.*\\\\.com$"')]),v._v(" 匹配 "),o("code",[v._v('"www.google.com"')]),v._v("、"),o("code",[v._v('"fonts.googleapis.com"')]),v._v("，但不匹配 "),o("code",[v._v('"google.com"')]),v._v("。")]),v._v(" "),o("li",[o("strong",[v._v("从文件中加载域名")]),v._v("：形如 "),o("code",[v._v('"ext:file:tag"')]),v._v("，必须以 "),o("code",[v._v("ext:")]),v._v("（小写）开头，后面跟 文件名 和 标签 ，文件存放在与v2ray核心相同的路径中，文件格式与 "),o("code",[v._v("geosite.dat")]),v._v(" 相同，标签 必须在文件中声明。")])]),v._v(" "),o("div",{staticClass:"custom-block tip"},[o("p",{staticClass:"custom-block-title"},[v._v("长话短说，我是萌新 😅")]),v._v(" "),o("ul",[o("li",[v._v("如果你不想考虑分流 只想代理全部的流量，请按照上方的 全局代理 步骤操作 😅")]),v._v(" "),o("li",[v._v("如果您想要实现精确的分流，即代理所有的出站流量，请点击下方的 "),o("code",[v._v("预设方案")]),v._v(" 按钮。选择 "),o("code",[v._v("空白方案")]),v._v(" 或 "),o("code",[v._v("空白方案（去广告）")]),v._v("，并将域名策略设置为 "),o("code",[v._v("IPIfNonMatch")]),v._v(" 😋")])])]),v._v(" "),o("div",{staticClass:"custom-block tip"},[o("p",{staticClass:"custom-block-title"},[v._v("我是个老司机 ，我想要更加精准的分流！ 🤔")]),v._v(" "),o("p",[v._v("我们推荐您使用一个更加细化的 V2ray 路由规则集 项目地址："),o("a",{attrs:{href:"https://github.com/Loyalsoldier/v2ray-rules-dat",target:"_blank",rel:"noopener noreferrer"}},[v._v("Loyalsoldier/v2ray-rules-dat"),o("OutboundLink")],1),v._v(" 🤗")])]),v._v(" "),o("div",{staticClass:"custom-block tip"},[o("p",{staticClass:"custom-block-title"},[v._v("我想可以自定义的分流规则！ 🤪")]),v._v(" "),o("p",[v._v("请参考下一章节 "),o("strong",[v._v("路由编辑器")]),v._v(" 😄")])]),v._v(" "),o("h2",{attrs:{id:"路由编辑器"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#路由编辑器"}},[v._v("#")]),v._v(" 路由编辑器")]),v._v(" "),o("p",[v._v("在 Qv2ray的主界面，"),o("strong",[v._v("右键点击")]),v._v(" 代理节点，然后选择 "),o("strong",[v._v("编辑为一个复杂配置")]),v._v(" 打开 "),o("strong",[v._v("路由编辑器")]),v._v(" 接口。")]),v._v(" "),o("p",[v._v("在这个界面中，你可以把"),o("strong",[v._v("用户")]),v._v("，"),o("strong",[v._v("源IP地址")]),v._v("，"),o("strong",[v._v("目标IP地址")]),v._v("，"),o("strong",[v._v("域名")]),v._v("，"),o("strong",[v._v("目标域名")]),v._v("，"),o("strong",[v._v("协议")]),v._v("和"),o("strong",[v._v("端口")]),v._v("任意设置组合，精准地设计出你想要的入站/出站规则. 你还可以调整不同规则之间的"),o("strong",[v._v("优先级")]),v._v("，甚至可以实现"),o("strong",[v._v("负载均衡")]),v._v("。")]),v._v(" "),o("p",[v._v("需要再次重申的是，每条路由规则中的匹配条件是 "),o("code",[v._v("and")]),v._v(" / "),o("code",[v._v("&&")]),v._v(" 关系 也就是说，如果路由规则包含多个匹配条件，最终获得的实际匹配条件就是这些条件的交集。例如，如果路由规则包含 端口 规则 "),o("code",[v._v("443")]),v._v(" 和 目标域名 规则 "),o("code",[v._v("qv2ray.github.io")]),v._v("，那么只有目标 "),o("code",[v._v("qv2ray.github.io:443")]),v._v(" 符合这两项条件，并将与此项规则相匹配。")]),v._v(" "),o("p",[v._v("如果您对 V2Ray 路由规则的作用机制不了解，请参阅V2Ray的官方文档。")])])}),[],!1,null,null,null);_.default=e.exports}}]);