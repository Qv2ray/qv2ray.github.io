(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{426:function(_,v,e){"use strict";e.r(v);var t=e(16),a=Object(t.a)({},(function(){var _=this,v=_.$createElement,e=_._self._c||v;return e("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[e("h1",{attrs:{id:"手动生成-qv2ray"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#手动生成-qv2ray"}},[_._v("#")]),_._v(" 手动生成 Qv2ray")]),_._v(" "),e("p",[_._v("如果黑客想手动编译 Qv2ray")]),_._v(" "),e("h2",{attrs:{id:"_0-需求和依赖关系"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_0-需求和依赖关系"}},[_._v("#")]),_._v(" 0. 需求和依赖关系")]),_._v(" "),e("p",[_._v("请确保您已经达到了所有要求。")]),_._v(" "),e("ul",[e("li",[e("p",[e("code",[_._v("x64")]),_._v("只适用于桌面平台。")])]),_._v(" "),e("li",[e("p",[e("code",[_._v("arm")]),_._v(", "),e("code",[_._v("arm64")]),_._v(", "),e("code",[_._v("x86")]),_._v(", "),e("code",[_._v("x86_64")]),_._v(" for Android 平台。")])]),_._v(" "),e("li",[e("p",[_._v("桌面平台需要Qt 版本"),e("code",[_._v(">= 5.11")]),_._v(" "),e("code",[_._v(">= 6.0")]),_._v(" Android。")]),_._v(" "),e("ul",[e("li",[_._v("~"),e("s",[_._v("从不想要将 Qv2ray 移植到更早或更晚版本的 Qt.")])]),_._v(" "),e("li",[_._v("在这种情况下，您可能想要修改 "),e("code",[_._v("QV_QT_MAJOR_VERSION")]),_._v(" 和 "),e("code",[_._v("QV_QT_MINOR_VERSION")]),_._v(" 在 "),e("code",[_._v("CMakeLists.txt")])])])]),_._v(" "),e("li",[e("p",[_._v("总是支持和推荐最新版本的 Qt")])]),_._v(" "),e("li",[e("p",[_._v("支持"),e("code",[_._v("std=c+17")]),_._v(" 编译器：")]),_._v(" "),e("ul",[e("li",[e("code",[_._v("gcc7")]),_._v("已知很好。")]),_._v(" "),e("li",[_._v("至少需要14.2版MSVC。")])])]),_._v(" "),e("li",[e("p",[_._v("第三方图书馆：(gRPC、原始、曲线、开放)")]),_._v(" "),e("table",[e("thead",[e("tr",[e("th",[_._v("目标平台")]),_._v(" "),e("th",[_._v("安装方法")])])]),_._v(" "),e("tbody",[e("tr",[e("td",[_._v("Linux")]),_._v(" "),e("td",[_._v("安装相应的软件包")])]),_._v(" "),e("tr",[e("td",[_._v("窗口 (MSVC)")]),_._v(" "),e("td",[_._v("使用 "),e("code",[_._v("vcpkg")]),_._v(" 或使用 "),e("a",{attrs:{href:"#a-prebuilt-binaries"}},[e("strong",[_._v("预构建的二进制文件")])])])]),_._v(" "),e("tr",[e("td",[_._v("Windows (MinGW)")]),_._v(" "),e("td",[_._v("See "),e("a",{attrs:{href:"#mingw-packages"}},[_._v("Below")])])]),_._v(" "),e("tr",[e("td",[_._v("macOS")]),_._v(" "),e("td",[_._v("通过 "),e("code",[_._v("homebrew")]),_._v("安装软件包, (注意：curl 已经预先安装)")])]),_._v(" "),e("tr",[e("td",[_._v("Android")]),_._v(" "),e("td",[_._v("支持Linux 主机。使用 "),e("a",{attrs:{href:"#a-prebuilt-binaries"}},[e("strong",[_._v("预构建二进制")])]),_._v(",")])])])]),_._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[_._v("Extra Git Submoule for Android [android-openssl](https://github.com/KDAB/android_openssl) provides OpenSSL binaries: use `git clone https://github.com/KDAB/android_openssl 3rdparty/android-openssl` ::: :")])])])]),_._v(" "),e("h3",{attrs:{id:"a-预建的二进制文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#a-预建的二进制文件"}},[_._v("#")]),_._v(" a. 预建的二进制文件")]),_._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/Qv2ray/Qv2ray-deps/",target:"_blank",rel:"noopener noreferrer"}},[_._v("Qv2ray-deps"),e("OutboundLink")],1),_._v(" repo 是我们构建并提供针对Windows 和 Android 的预建库依赖关系的地方。")]),_._v(" "),e("li",[_._v("For Android version, we have used a "),e("a",{attrs:{href:"https://github.com/Qv2ray/Qv2ray-deps/blob/master/0001_vcpkg_fix_curl_android_build.patch",target:"_blank",rel:"noopener noreferrer"}},[_._v("patched"),e("OutboundLink")],1),_._v(" vcpkg.")])]),_._v(" "),e("h4",{attrs:{id:"a-1-下载-提取脚本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#a-1-下载-提取脚本"}},[_._v("#")]),_._v(" a.1 下载/提取脚本")]),_._v(" "),e("p",[e("strong",[_._v("额外依赖关系: bash, jq, curl, 7zip")]),_._v(" (专门适用于 Windows 用户)")]),_._v(" "),e("p",[_._v("我们提供了 "),e("code",[_._v("./libs/setup-lib.sh")]),_._v(" 以便于安装预构建的二进制文件，用法：")]),_._v(" "),e("ul",[e("li",[e("code",[_._v("cd")]),_._v(" to "),e("code",[_._v("libs")]),_._v(" 目录")]),_._v(" "),e("li",[e("code",[_._v("./setup-libs <PLATFORM> <ARCH>")]),_._v(" "),e("ul",[e("li",[_._v("例如： "),e("code",[_._v("./setup-libs.sh windows x64")]),_._v(" or "),e("code",[_._v("./setup-libs.sh android arm")])]),_._v(" "),e("li",[_._v("可能的 "),e("code",[_._v("<PLATFORM>")]),_._v(" 值： "),e("code",[_._v("winds")]),_._v(", "),e("code",[_._v("linux")]),_._v(", "),e("code",[_._v("android")])]),_._v(" "),e("li",[_._v("可能的 "),e("code",[_._v("<ARCH>")]),_._v(" 值： "),e("code",[_._v("x86")]),_._v(", "),e("code",[_._v("x64")]),_._v(", "),e("code",[_._v("arm")]),_._v(", "),e("code",[_._v("arm64")])]),_._v(" "),e("li",[_._v("Set "),e("code",[_._v("<ARCH>")]),_._v(" to "),e("code",[_._v("tools")]),_._v(" to install Protobuf generator binaries when cross-compiling to Android on Linux")])])])]),_._v(" "),e("p",[_._v("脚本从 "),e("a",{attrs:{href:"https://github.com/Qv2ray/Qv2ray-deps/releases/tag/release",target:"_blank",rel:"noopener noreferrer"}},[_._v("这个版本"),e("OutboundLink")],1),_._v(" 下载和提取的软件包，移动内容到 corrensponding "),e("code",[_._v("./libs/ARCH-PLATFORM /")]),_._v(" 目录。")]),_._v(" "),e("h4",{attrs:{id:"a-2-手动获取预构建的二进制文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#a-2-手动获取预构建的二进制文件"}},[_._v("#")]),_._v(" a.2 手动获取预构建的二进制文件")]),_._v(" "),e("ul",[e("li",[_._v("下载7z 文件")]),_._v(" "),e("li",[_._v("解压并移动 "),e("code",[_._v("{7Z_ROOT}/PLATFORM-ARCH/已安装/ARCH-PLATFORM")]),_._v(" 到 "),e("code",[_._v("./libs/")]),_._v(" 目录。")]),_._v(" "),e("li",[_._v("必须有 "),e("code",[_._v("包含")]),_._v(", "),e("code",[_._v("lib")]),_._v(" 或 "),e("code",[_._v("共享")]),_._v(" 子目录在 "),e("code",[_._v("./libs/ARCH-PLATFORM")]),_._v(" "),e("ul",[e("li",[_._v("例如： "),e("code",[_._v("./libs/x86-android/include")]),_._v(" 或 "),e("code",[_._v(".libs/x64-windows/incluse/")]),_._v(" 存在")])])])]),_._v(" "),e("h3",{attrs:{id:"mingw-软件包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mingw-软件包"}},[_._v("#")]),_._v(" MinGW 软件包：")]),_._v(" "),e("p",[_._v("建议使用MSYS2，软件包：")]),_._v(" "),e("ul",[e("li",[e("code",[_._v("mingw-w64-x86_64-grpc")])]),_._v(" "),e("li",[e("code",[_._v("mingw-w64-x86_64-curl")])]),_._v(" "),e("li",[e("code",[_._v("mingw-w64-x86_64-protobuf")])]),_._v(" "),e("li",[e("code",[_._v("mingw-w64-x86_64-protobuf-c")])]),_._v(" "),e("li",[e("code",[_._v("mingw-w64-x86_64-pkg-config")])]),_._v(" "),e("li",[e("code",[_._v("mingw-w64-x86_64-re2")])])]),_._v(" "),e("h2",{attrs:{id:"_1-获取源树"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-获取源树"}},[_._v("#")]),_._v(" 1. 获取源树")]),_._v(" "),e("p",[_._v("获取Qv2ray源代码有各种方法。 你可以从：")]),_._v(" "),e("ul",[e("li",[_._v("Git:"),e("code",[_._v("https://github.com/Qv2ray/Qv2ray.git")])]),_._v(" "),e("li",[_._v("直接下载分支的源代码("),e("strong",[_._v("因为缺少git子模块元数据而永远不会这样做。")]),_._v(") ::::tip 你可以在 "),e("code",[_._v("git 克隆")]),_._v(" "),e("code",[_._v("--brant <branch/tag>")]),_._v(" 在克隆创建后结帐指定分支/标签。 :::")])]),_._v(" "),e("p",[_._v(":::警告 Qv2ray 包含嵌套子模块，在克隆时总是使用 "),e("code",[_._v("--递归")]),_._v(" :::")]),_._v(" "),e("h2",{attrs:{id:"_2-进入编译目录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-进入编译目录"}},[_._v("#")]),_._v(" 2. 进入编译目录")]),_._v(" "),e("p",[_._v("以下步骤需要一个适当的 "),e("code",[_._v("PATH")]),_._v(", 也就是说， "),e("code",[_._v("qmake")]),_._v(" 可以在 "),e("code",[_._v("PATH")]),_._v(" 中找到。")]),_._v(" "),e("p",[_._v("运行: "),e("code",[_._v("mkdir build; cd build;")])]),_._v(" "),e("ul",[e("li",[_._v("只是为了防止源树中的污染。")])]),_._v(" "),e("h2",{attrs:{id:"_3-生成编译脚本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-生成编译脚本"}},[_._v("#")]),_._v(" 3. 生成编译脚本")]),_._v(" "),e("p",[_._v("您 "),e("strong",[_._v("需要")]),_._v(" 查看 "),e("a",{attrs:{href:"cmake-argument"}},[_._v("CMake 参数")]),_._v(" 并添加您自己的参数。")]),_._v(" "),e("p",[_._v("运行: "),e("code",[_._v("cmake ...")])]),_._v(" "),e("p",[e("em",[e("strong",[_._v("对于Android，建议使用 "),e("code",[_._v("qt-cke...")]),_._v(" 替代 "),e("code",[_._v("cmake ...")]),_._v("。")])])]),_._v(" "),e("ul",[e("li",[e("code",[_._v("一直建议CMAKE_INSTALL_PREFIX")]),_._v(" 来打包和收集所有必需的文件。")]),_._v(" "),e("li",[e("code",[_._v("CMAKE_BUILD_TYPE")]),_._v(" 总是被推荐的，请参阅 "),e("a",{attrs:{href:"https://cmake.org/cmake/help/latest/variable/CMAKE_BUILD_TYPE.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("CMake 文档"),e("OutboundLink")],1),_._v(" "),e("ul",[e("li",[e("code",[_._v("调试")]),_._v(" and "),e("code",[_._v("Release")]),_._v(" building will have different name for Qv2ray config 目录， 防止开发工程损坏配置的工作副本。")])])]),_._v(" "),e("li",[e("code",[_._v("-GNinja")]),_._v(" 被推荐。iff您有 "),e("code",[_._v("Ninja")]),_._v(" 或 "),e("code",[_._v("ninja build")]),_._v(" 已安装。")]),_._v(" "),e("li",[e("code",[_._v("Android可能需要 ANDROID_SDK_ROOT")]),_._v(" 或 "),e("code",[_._v("ANDROID_NDK_ROOT")])])]),_._v(" "),e("h2",{attrs:{id:"_4-开始编译"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-开始编译"}},[_._v("#")]),_._v(" 4. 开始编译")]),_._v(" "),e("p",[_._v("开始编译！")]),_._v(" "),e("p",[_._v("运行： "),e("code",[_._v("cmake --build。")])]),_._v(" "),e("ul",[e("li",[e("code",[_._v("--partial <NUMBER>")]),_._v(" 如果您有足够的计算功率并想要执行并行编译，则是糖果。")])]),_._v(" "),e("h2",{attrs:{id:"_5-完成编译"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-完成编译"}},[_._v("#")]),_._v(" 5. 完成编译")]),_._v(" "),e("p",[_._v("复制已编译的伪影和资源到目标目录。")]),_._v(" "),e("p",[_._v("运行： "),e("code",[_._v("cmake --install 。")]),_._v(" 或 "),e("code",[_._v("sudo")])]),_._v(" "),e("ul",[e("li",[_._v("这将自动将所有依赖项复制到 "),e("code",[_._v("CMAKE_INSTALL_PREFIX")]),_._v("。")])]),_._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[_._v("There's a bug in `macdeployqt` where `libabsl_debugging_internal` is recognized as a debug library. 阻止QPlatform插件(例如) 正在部署的 QCocoaPlugin。 这会导致运行时异常，告诉“找不到平台插件”。")]),_._v(" "),e("p",[_._v("使用 "),e("a",{attrs:{href:"https://github.com/Qv2ray/macdeployqt-patched",target:"_blank",rel:"noopener noreferrer"}},[_._v("Qv2ray-补丁 "),e("code",[_._v("macdeplaudqt")]),e("OutboundLink")],1),_._v(" 代替。 同时支持 Qt5 和 Qt6 :::")]),_._v(" "),e("h2",{attrs:{id:"_6-完成"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-完成"}},[_._v("#")]),_._v(" 6. 完成")]),_._v(" "),e("p",[_._v("您已编译和部署您的 Qv2ray ！")]),_._v(" "),e("p",[_._v("开始黑客并欢迎贡献Qv2光！")])])])}),[],!1,null,null,null);v.default=a.exports}}]);