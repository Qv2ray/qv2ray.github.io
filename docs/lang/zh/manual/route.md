---
title: é«˜çº§è·¯ç”±è®¾ç½®
---

# é«˜çº§è·¯ç”±è®¾ç½®

**é«˜çº§è·¯ç”±è®¾ç½®** å’Œ **è·¯ç”±ç¼–è¾‘å™¨** æ˜¯Qv2rayçš„ç‰¹æœ‰åŠŸèƒ½ã€‚ è¿™ä¸¤é¡¹åŠŸèƒ½å¯ä»¥å¸®åŠ©æ‚¨ç²¾ç¡®åœ°æ§åˆ¶æµé‡ï¼Œå¦‚ **æŒ‰éœ€ä»£ç†**ï¼Œ **åˆ†æµå›½å†…/å›½å¤–ç½‘ç«™**ç­‰ã€‚ ä½ ç”šè‡³å¯ä»¥ **è®¾ç½®ä»£ç†é“¾(å¤šå±‚å¥—å¨ƒ)**ğŸ¤£~

:::  è·¯ç”±åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿ ä¸ºä»€ä¹ˆä¸ç”¨ PAC å’Œ GFW List?

å¦‚æœä½ ä¸äº†è§£ V2ray çš„è·¯ç”±åŠŸèƒ½å…·ä½“æ˜¯ä»€ä¹ˆ, é‚£ä¹ˆä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä¸ªæ›´åŠ ç®€ä¾¿, é«˜æ•ˆä¸”ç²¾å‡†çš„æ–°ä¸€ä»£ PAC å®ç°ã€‚

è·¯ç”±åŠŸèƒ½ æ¯” PAC å¼ºå¤§å¤ªå¤š, ä»¥åè¯·åˆ«å†é—®ä¸ºä»€ä¹ˆ Qv2ray ä¸æ”¯æŒ PAC äº†ã€‚ è·¯ç”±åŠŸèƒ½æ‰€é‡‡ç”¨çš„åˆ†æµè¡¨ä¹Ÿæ¯” GFW List æ›´åŠ å®Œå–„ï¼Œå®Œå…¨æ²¡æœ‰å¿…è¦å†ä½¿ç”¨GFW Listã€‚

:::

## å…¨å±€è·¯ç”±è§„åˆ™

é…ç½®å…¨å±€è·¯ç”±è§„åˆ™ è¯·æ‰“å¼€**é¦–é€‰é¡¹** ---> **é«˜çº§è·¯ç”±è®¾ç½®** ã€‚

### åŸŸåç­–ç•¥

Qv2ray æœ‰ä¸‰ç§åŸŸååŒ¹é…ç­–ç•¥å¯é€‰ï¼š `AsIs`, `IPIfNonMatch`, å’Œ ` IPOnDemand`.

æ ¹æ®V2Rayçš„å®˜æ–¹æ–‡æ¡£ï¼Œè¿™ä¸‰ç§åŸŸåç­–ç•¥çš„å®šä¹‰å¦‚ä¸‹ï¼š

- **`AsIs`**: åªä½¿ç”¨åŸŸåè¿›è¡Œè·¯ç”±é€‰æ‹©ï¼Œ é»˜è®¤å€¼;
- **`IPIfNonMatch`**: å½“åŸŸåæ²¡æœ‰åŒ¹é…ä»»ä½•è§„åˆ™æ—¶ï¼Œå°†åŸŸåè§£ææˆ IPï¼ˆA è®°å½•æˆ– AAAA è®°å½•ï¼‰åå†æ¬¡è¿›è¡ŒåŒ¹é…ï¼›
  - å½“ä¸€ä¸ªåŸŸåæœ‰å¤šä¸ª A è®°å½•æ—¶ï¼Œä¼šå°è¯•åŒ¹é…æ‰€æœ‰çš„ A è®°å½•ï¼Œç›´åˆ°å…¶ä¸­ä¸€ä¸ªä¸æŸä¸ªè§„åˆ™åŒ¹é…ä¸ºæ­¢ï¼›
  - è§£æåçš„ IP ä»…åœ¨è·¯ç”±é€‰æ‹©æ—¶èµ·ä½œç”¨ï¼Œè½¬å‘çš„æ•°æ®åŒ…ä¸­ä¾ç„¶ä½¿ç”¨åŸå§‹åŸŸå;
- **`IPOnDemand`**: åŒ¹é…æ—¶ç¢°åˆ°ä»»ä½•åŸºäº IP çš„è§„åˆ™ï¼Œç«‹å³å°†åŸŸåè§£æä¸º IP åè¿›è¡ŒåŒ¹é…;

ç”¨æŸä½å¼€å‘è€…çš„è¯è¯´, å°±æ˜¯:

- **`AsIs`**: åˆ†æµé€Ÿåº¦å¿«, ä½†åˆ†æµä¸å¤Ÿç²¾ç¡®;
- **`IPIfNonMatch`**: åœ¨ç‰ºç‰²éƒ¨åˆ†é€Ÿåº¦çš„åŒæ—¶èƒ½å¸¦æ¥è¶³å¤Ÿç²¾ç¡®çš„åˆ†æµ;
- **`IPOndemand`**: åˆ«ç”¨;

> è¯·æ³¨æ„: `IPOnDemand` ç†è®ºä¸Šæ˜¯æœ€æ…¢è€Œç»“æœæœ€å‡†ç¡®çš„ï¼Œç„¶è€Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ `IPIfNonMatch` å·²ç»è¶³å¤Ÿå‡†ç¡®äº†ï¼Œæ‰€ä»¥ `IPOndemand` çš„å®é™…åº”ç”¨æ•ˆæœå¹¶ä¸æ˜æ˜¾ã€‚

æ‚¨å¯ä»¥æ ¹æ®æ‚¨çš„å®é™…éœ€æ±‚é€‰æ‹©æœ€é€‚åˆä½ çš„åŸŸååŒ¹é…ç­–ç•¥ã€‚ ä½†å°±ç»“æœæ¥è¯´ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ`IPIfNonMatch` æ˜¯æœ€ä½³é€‰æ‹©ã€‚

### è·¯ç”±ç­–ç•¥

è·¯ç”±ç­–ç•¥ç”± `3x2`  ä¸ªåŒºå—ç»„æˆï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ï¼ˆå·¦ä¸Šåˆ°å³ä¸‹ï¼‰ï¼š `IP ç›´è¿` ,`IP ä»£ç†`, `IP é˜»æ–­`ï¼Œ`åŸŸåç›´è¿`, `åŸŸåä»£ç†`, `åŸŸåé˜»æ–­`, å¡«å…¥è§„åˆ™æ—¶è¯·ä¿æŒ **æ¯è¡Œä¸€ä¸ªï¼Œä¸­é—´æ²¡æœ‰é€—å·åˆ†éš”**ã€‚

Qv2ray å¯¹äºè¿™äº›ç­–ç•¥ç»„çš„ä¼˜å…ˆçº§æ’åºæ˜¯: `åŸŸåé˜»æ–­` -> `åŸŸåä»£ç†` -> `åŸŸåç›´è¿` -> `IP é˜»æ–­` -> `IP ä»£ç†` -> `IP ç›´è¿`ã€‚ å¦‚æœæœ€åæ²¡æœ‰æˆåŠŸåŒ¹é…, ç§æœ‰åœ°å€ å’Œ ä¸­å›½å¤§é™†åœ°å€ ä¼šé»˜è®¤ç›´è¿, å…¶ä»–åœ°å€åˆ™ä¼šä½¿ç”¨ä»£ç†ã€‚

:::tip æˆ‘å°±æƒ³è¦å…¨å±€ä»£ç†~~~ ğŸ¤—

å¾ˆç®€å•ï¼Œ æ¸…ç©ºæ‰€æœ‰çš„è·¯ç”±è§„åˆ™ ç„¶åæ‰“å¼€ **é¦–é€‰é¡¹** ---> ** é“¾æ¥è®¾ç½®** å–æ¶ˆå‹¾é€‰ ** ç»•è¿‡ç§æœ‰åœ°å€ **å’Œ ** ç»•è¿‡ä¸­å›½å¤§é™†** å³å¯ ğŸ™„

:::

æ ¹æ® V2Ray å®˜æ–¹æ–‡æ¡£ï¼š

IPè§„åˆ™æœ‰ä»¥ä¸‹å‡ ç§å†™æ³•(æŒ‰ç…§æ˜¯å¦å¸¸ç”¨æ’åº):

- **GeoIP**: å½¢å¦‚ "geoip:cn"ï¼Œå¿…é¡»ä»¥ geoip:ï¼ˆå°å†™ï¼‰å¼€å¤´ï¼Œåé¢è·ŸåŒå­—ç¬¦å›½å®¶ä»£ç ã€‚ ä¾‹å¦‚ ï¼š`geoip:cn`  åŒ…å«äº†å¸¸è§çš„ä¸­å›½IPåœ°å€ï¼Œ`geoip:us` åŒ…å«äº†å¸¸è§çš„ç¾å›½IPåœ°å€ï¼›
- ç‰¹æ®Šå€¼ï¼š"geoip:private"ï¼ˆä»…æ”¯æŒV2Ray 3.5+ï¼‰ï¼ŒåŒ…å«æ‰€æœ‰ç§æœ‰åœ°å€ï¼Œå¦‚ 127.0.0.1ã€‚
- IPï¼šç›´æ¥å¡«å†™ï¼Œå½¢å¦‚ "127.0.0.1"ã€‚
- **CIDR**ï¼šå½¢å¦‚ "10.0.0.0/8"ã€‚
- **ä»æ–‡ä»¶ä¸­åŠ è½½ IP**ï¼šå½¢å¦‚ `"ext:file:tag"`ï¼Œå¿…é¡»ä»¥` ext:`ï¼ˆå°å†™ï¼‰å¼€å¤´ï¼Œåé¢è·Ÿæ–‡ä»¶åï¼ˆä¸å¸¦æ‰©å±•åï¼‰ï¼Œæ–‡ä»¶å­˜æ”¾åœ¨ `èµ„æºç›®å½•ï¼ˆé»˜è®¤å’Œ v2ray æ ¸å¿ƒæ–‡ä»¶åŒè·¯å¾„ï¼‰` ä¸­ï¼Œæ–‡ä»¶æ ¼å¼ä¸ geoip.dat ç›¸åŒã€‚ æ–‡ä»¶æ ¼å¼ä¸ `geoip.dat` ç›¸åŒï¼Œ `tag` å¿…é¡»åœ¨æ–‡ä»¶ä¸­å£°æ˜ã€‚

åŸŸåè§„åˆ™æœ‰ä»¥ä¸‹å‡ ç§å†™æ³•(æŒ‰ç…§æ˜¯å¦å¸¸ç”¨æ’åº):

- **é¢„å®šä¹‰åŸŸååˆ—è¡¨**: ä»¥ `geosite:`å¼€å¤´, åé¢è·Ÿä¸€ä¸ªåç§°ï¼Œä¾‹å¦‚ `geosite:google` æˆ– `geosite:cn` åç§° åŠ åŸŸååˆ—è¡¨ è¯·å‚è€ƒ _é¢„å®šä¹‰åŸŸååˆ—è¡¨_
- **å­åŸŸå**ï¼šç”± `"domain:" `å¼€å§‹ï¼Œåé¢è·Ÿä¸€ä¸ªåŸŸåã€‚ å½“æ­¤åŸŸåæ˜¯ç›®æ ‡åŸŸåæˆ–å…¶å­åŸŸåæ—¶ï¼Œè¯¥è§„åˆ™ç”Ÿæ•ˆã€‚ ä¾‹å¦‚` "domain:v2ray.com"` åŒ¹é…` "www.v2ray.com"`ã€`"v2ray.com"`ï¼Œä½†ä¸åŒ¹é… `"xv2ray.com"`ã€‚
- **å®Œå…¨åŒ¹é…**ï¼š ç”±</strong> "full:" </code>å¼€å§‹ï¼Œåé¢è·Ÿä¸€ä¸ªåŸŸåã€‚ å½“æ­¤åŸŸåå®Œæ•´åŒ¹é…ç›®æ ‡åŸŸåæ—¶ï¼Œè¯¥è§„åˆ™ç”Ÿæ•ˆã€‚ ä¾‹å¦‚` "full:v2ray.com" `åŒ¹é…`"v2ray.com" `ä½†ä¸åŒ¹é…` "www.v2ray.com"ã€‚`
- **çº¯å­—ç¬¦ä¸²**ï¼šå½“æ­¤å­—ç¬¦ä¸²åŒ¹é…ç›®æ ‡åŸŸåä¸­ä»»æ„éƒ¨åˆ†ï¼Œè¯¥è§„åˆ™ç”Ÿæ•ˆã€‚ æ¯”å¦‚`"sina.com" `å¯ä»¥åŒ¹é… `"sina.com"`ã€`"sina.com.cn" `å’Œ `"www.sina.com"`ï¼Œä½†ä¸åŒ¹é… `"sina.cn"`ã€‚
- **æ­£åˆ™è¡¨è¾¾å¼**ï¼šç”± `"regexp:"` å¼€å§‹ï¼Œä½™ä¸‹éƒ¨åˆ†æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ã€‚ å½“æ­¤æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç›®æ ‡åŸŸåæ—¶ï¼Œè¯¥è§„åˆ™ç”Ÿæ•ˆã€‚ ä¾‹å¦‚` "regexp:\\.goo.*\\.com$"` åŒ¹é… `"www.google.com"`ã€`"fonts.googleapis.com"`ï¼Œä½†ä¸åŒ¹é…` "google.com"`ã€‚
- **Loading domain list from external files**: the format is `ext:file:tag`, which must start with `ext:` (all lowercase), followed by the file name (without extension) `file` and `tag`, and the file must be stored in the V2Ray core resource directory. The file format is the same as `geosite.dat`, and the specified `tag` must exist in the file.

:::tip I'm a newbie, can you be more straightforward?

- If you want to implement a global proxy, that is, regardless of the destination address, all traffic will go through the proxy, then refer to the other tips above. ğŸ˜…
- If you want to achieve precise traffict splitting, that is, all outbound traffic should go through the proxy, then just click the `preset plans` button in the interface, select the `blank plan` or the `ad blocking plan`, and set the domain name strategy to `IPIfNonMatch`. ğŸ˜‹

:::

:::tip I'm a advanced user! I want more precise traffic splitting! ğŸ¤”

We recommends using an enhanced version of the V2Ray rules file project. The project is at [Loyalsoldier/v2ray-rules-dat](https://github.com/Loyalsoldier/v2ray-rules-dat). ğŸ¤—

:::

:::tip I want a highly customizable traffic splitting rules! ğŸ¤ª

Please refer to the next section **Routing Editor**. ğŸ˜„

:::

## Routing Editor

In the main interface of Qv2ray, **right-click** the agent node and select **Edit as a complex configuration** to open the **Route Editor** interface.

In this interface, you can arbitrarily combine matching conditions such as **user**, **source IP**, **target IP**, **domain name**, **target domain name**, **protocol**, and **port** to create sufficiently accurate inbound/outbound rules, and you can also adjust the **priority** of the rules arbitrarily Level, even achieving **load balancing**.

What needs reiterating is that the matching conditions in each routing rule are `and` / `&&` relationships, that is, if a routing rule contains multiple matching conditions, the actual matching conditions finally obtained are the intersection of these conditions. For example, if a routing rule contains both the port condition `443` and the target domain name condition `qv2ray.github.io`, then only the target `qv2ray.github.io:443` that meets both conditions will match this item rule.

If you don't know much about V2Ray's routing rules mechanism, please refer to V2Ray's official documentation.
